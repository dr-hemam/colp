{% extends 'base.html' %}

{% block title %}
ConOccult - Reporting Cycles
{% endblock %}

{% block content %}
<div class="row">
    <div class ="col-md-8">
        <h1>Look Ahead Activities Form</h1>
        <h3>Week Commencing {{lookahead}}</h3>
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            
            {% for category, message in messages %}
            <ul class='flashes alert {{ category }} alert-dismissable'>
              <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
              <li>{{ message }}</li>
             </ul>
            {% endfor %}
            
          {% endif %}
        {% endwith %}
        
        {% from '_formhelpers.html' import render_field_nolabel %}
        {% if action=='new' %}<form method="POST" action ={{ url_for('new_lookahead_details', id= lookahead.id) }} role ="form">
        {% else %}<form method="POST" action= {{ url_for('edit_lookahead_detail', tid = task.id )  }} role="form">
        {% endif %}
        {{ form.hidden_tag() }}
        <table>
        <tr><th>ID</th><th>Name</th><th>Start</th><th>Finish</th><th>Active</th></tr>
        <tr class="tr_clone">
            <td>{{ render_field_nolabel(form.task_code, class="form-control") }}</td>
            <td>{{ render_field_nolabel(form.task_name, class="form-control") }}</td>
            <td>{{ render_field_nolabel(form.start, class="form-control") }}</td>
            <td>{{ render_field_nolabel(form.finish, class="form-control") }}</td>
            <td>{{ render_field_nolabel(form.is_active, class="form-control") }}</td>
            {% if action=='new' %}<td><input type="button" name="add" value="Add" class="tr_clone_add"></td>
            {% endif %}
        </tr>
        </table>
        <button type ="submit" class="btn btn-default">Save</button>
        </form>

    </div>
</div>
<script>
$(document).ready(function(){
    $(document).on('click',"input.tr_clone_add", function() {
    var $tr    = $(this).closest('.tr_clone');
    var $clone = $tr.clone();
    $clone.find(':text').val('');
    $tr.after($clone);
});
});
</script>
{% endblock %}